<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERP System</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Ensure the content below the fixed header isn't hidden */
        body {
            padding-top: 64px; /* Adjust based on header height */
        }
        .button {
            border: none;
            color: white;
            padding: 10px 21px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 24px; /* Rounded corners */
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
        }

        .button_green {
            background-color: #04AA6D;
            transition: background-color 0.3s ease;
        } /* Green */
        .button_green:hover {
            background-color: #06812f; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
        }
        .button_grey {
            background-color: #7c8380;
            transition: background-color 0.3s ease;
        } /* Grey */
        .button_grey:hover {
            background-color: #29282b;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
        }
        .button_blue {
            background-color: #008CBA;
            transition: background-color 0.3s ease;
        } /* Blue */
        .button_blue:hover {
            background-color: #02516b; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
        }
        .button_purple {
            background-color: #c10898;
            transition: background-color 0.3s ease;
        } /* Purple */
        .button_purple:hover {
            background-color: #670451;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Enhanced shadow on hover */
        }
        
        .table_bordered {
            border: 2px solid;
            border-collapse: collapse;
        }
        .table_bordered th, .table_bordered td {
        border: 1px solid black;
        padding: 8px;
        }
        .table_unbordered {
            border: 0px;
            border-collapse: collapse;
        }
        .table_unbordered th, .table_unbordered td {
        padding: 8px;
        }

        .table_home {
            border: 0px;
            width: 100%;
            height: 100%;
        }
        .table_home th, .table_home td {
            padding: 5px;
            text-align: center;
        }
        .button_home {
            background-color: #8B5CF6;
            color: #F5F5F5;
            padding: 15px 30px;
            text-align: center;
            text-decoration: none;
            display: block;
            width: 100%;
            height: 100%;               /* Take all available height */
            max-height: 300px;          /* Set your preferred max height */
            font-size: 32px;
            margin: 16px auto;
            cursor: pointer;
            border: 1px solid #6D28D9;
            border-radius: 56px;
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
            box-sizing: border-box;     /* Ensures padding doesn't exceed max-height */
        }

        .button_home:hover {
            background-color: #6D28D9;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 400px;
            width: 90%;
        }
        .popup.success {
            border-left: 4px solid #04AA6D;
        }
        .popup.error {
            border-left: 4px solid #DC2626;
        }
        .popup-header {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .popup-close {
            background-color: #6B7280;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            float: right;
        }
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <!-- Header Ribbon -->
    <header class="fixed top-0 left-0 w-full bg-blue-600 text-white shadow-md z-10">
        <div class="container mx-auto flex items-center justify-between h-16 px-4">
            <!-- Logo on the Left -->
            <div class="flex items-center">
                <img src="https://via.placeholder.com/40" alt="ERP Logo" class="h-10 w-10 mr-2">
            </div>
            <!-- ERP System Title in the Center -->
            <div class="flex-1 text-center">
                <h1 class="text-2xl font-bold">ERP System</h1>
            </div>
            <!-- User Info and Logout Button on the Right -->
            <div id="userSection" class="flex items-center space-x-4">
                {% if current_user.is_authenticated %}
                <span id="username" class="text-lg">{{ current_user.username}}</span>
                    {% if current_user.role.role_name == 'admin' and request.path != url_for('users.manage_users') %}
                        <a href="{{ url_for('users.manage_users') }}"><button id="UsersButton" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-md">Users</button></a>
                    {% endif %}
                    {% if request.path != url_for('home') %}
                        <a href="{{ url_for('home') }}"><button id="UsersButton" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-md">Home</button></a>
                    {% endif %}
                <a href="{{ url_for('auth.logout') }}"><button id="logoutButton" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md">Logout</button></a>
                {% endif %}
            </div>
        </div>
    </header>

    <!-- Flash Messages as Popups -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, msg in messages %}
                <div class="popup {{ category }}">
                    <button class="popup-close" onclick="closePopup(this)">Close</button>
                    <div class="popup-header">{{ category | capitalize }}</div>
                    <div>{{ msg }}</div>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Main Content Area -->
    <main class="container mx-auto p-4">
        {% block title %}<h2 class="text-xl font-semibold mb-4" align="center"></h2>Welcome to ERP system</h2>{% endblock %}
        {% block content %}Default Text{% endblock %}
    </main>
    <script>
        // Show popups on page load if they exist
        document.addEventListener('DOMContentLoaded', () => {
            const popups = document.querySelectorAll('.popup');
            const overlay = document.getElementById('popupOverlay');
            if (popups.length > 0) {
                popups.forEach(popup => popup.style.display = 'block');
                overlay.style.display = 'block';
            }
        });

        // Close popup and hide overlay
        function closePopup(button) {
            const popup = button.parentElement;
            popup.style.display = 'none';
            // Hide overlay if no popups are visible
            const visiblePopups = document.querySelectorAll('.popup[style*="block"]');
            if (visiblePopups.length === 0) {
                document.getElementById('popupOverlay').style.display = 'none';
            }
        }
    </script>
</body>
</html>